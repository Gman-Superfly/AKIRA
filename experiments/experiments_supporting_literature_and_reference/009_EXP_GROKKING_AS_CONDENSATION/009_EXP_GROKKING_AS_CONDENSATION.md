# EXPERIMENT 009: Grokking as Condensation

## Is the Grokking Transition a Bose-Einstein Condensation?

---

## Status: PLANNED

## Tier: ★★ CORE

## Depends On: 004 (Phase Transition)

---

## 1. Problem Statement

### 1.1 The Question

Grokking is a well-documented phenomenon where neural networks suddenly generalize long after training loss has converged:

**Is grokking a phase transition analogous to Bose-Einstein condensation, a sudden collapse from memorized details to generalized structure?**

### 1.2 Why This Matters

```
THE GROKKING-CONDENSATION HYPOTHESIS

┌─────────────────────────────────────────────────────────────────────────┐
│                                                                         │
│  GROKKING:                                                              │
│  • Training loss converges (memorization)                              │
│  • Long plateau (apparent convergence)                                 │
│  • Sudden test loss drop (generalization)                             │
│                                                                         │
│  BEC CONDENSATION:                                                      │
│  • System above critical temperature (thermal)                        │
│  • Slow cooling (approaching threshold)                               │
│  • Sudden macroscopic occupation of ground state                     │
│                                                                         │
│  If same phenomenon:                                                    │
│  • Memorization = thermal phase (high entropy)                        │
│  • Plateau = approaching critical point                               │
│  • Grokking = condensation (sudden entropy collapse)                 │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 2. Hypothesis

### 2.1 Primary Hypothesis

**H1: Grokking exhibits phase transition signatures.**

- Entropy drops suddenly at grokking
- Order parameter (generalization) shows power-law approach
- Critical exponents measurable

### 2.2 Secondary Hypotheses

**H2: Pre-grokking phase shows building correlations.**
- Attention patterns become more structured before grokking
- Entropy decreases gradually, then suddenly

**H3: Critical exponents match those from Experiment 004.**

### 2.3 Null Hypothesis

**H0:** Grokking is gradual optimization, not phase transition.

---

## 3. Scientific Basis

### 3.1 Grokking Literature

**ESTABLISHED SCIENCE:**

```
Power et al. (2022): "Grokking: Generalization Beyond Overfitting"
• Observed sudden generalization on algorithmic tasks
• Occurs long after training loss converges
• Regularization and data size affect timing

Nanda et al. (2023): "Progress measures for grokking"
• Identified internal progress measures
• Grokking correlates with circuit formation

Reference: Power et al. (2022), Nanda et al. (2023)
```

### 3.2 AKIRA Theory Basis

**Relevant Theory Documents:**
- `bec/BEC_CONDENSATION_INFORMATION.md`, §5 (Grokking as Condensation)
- `architecture_theoretical/SPECTRAL_BELIEF_MACHINE.md`, §6 (Belief Collapse)
- `CANONICAL_PARAMETERS.md`, collapse_threshold = 0.3

**Key Concepts:**
- **Grokking as phase transition:** Sudden generalization = belief collapse from memorized (thermal) to structured (condensed)
- **Entropy trajectory:** High during memorization → plateau near critical point → sudden drop at grokking
- **Order parameter:** Fraction of attention concentrated on generalized structure (vs scattered over examples)
- **Critical slowing down:** Long plateau before grokking analogous to critical slowing near phase transition

**From BEC_CONDENSATION_INFORMATION.md (§5.2):**
> "Grokking is late-time condensation. Initially, network memorizes examples (thermal phase, high entropy). As regularization removes spurious correlations, system approaches critical point. Sudden drop in test loss is condensation event, collapse from many memorized patterns to single generalized structure."

**From SPECTRAL_BELIEF_MACHINE.md (§6.2):**
> "Collapse occurs when entropy H < collapse_threshold = 0.3. System transitions from diffuse (uncertain) to concentrated (certain) belief. Grokking is collapse at training timescale: long thermal phase → critical approach → sudden transition."

**This experiment validates:**
1. Whether grokking exhibits **phase transition signatures** (power-law scaling, critical exponents)
2. Whether entropy shows **sudden drop** at grokking (not gradual)
3. Whether **spectral cascade** occurs (low-freq bands grok before high-freq)
4. Whether critical exponents match **BEC universality class** (or other known class)

**Falsification:** If grokking is gradual OR no critical behavior → not a phase transition → BEC analogy invalid for this phenomenon.

---

## 4. Methods

### 4.1 Protocol

```
GROKKING CONDENSATION PROTOCOL

┌─────────────────────────────────────────────────────────────────────────┐
│                                                                         │
│  STEP 1: Setup grokking experiment                                     │
│  • Small algorithmic task (modular addition)                          │
│  • Configure for reliable grokking                                    │
│                                                                         │
│  STEP 2: Monitor throughout training                                   │
│  • Attention entropy at each step                                     │
│  • Training and test loss                                             │
│  • Per-band entropy (from Exp 003)                                    │
│                                                                         │
│  STEP 3: Detect grokking event                                         │
│  • Identify sudden test loss drop                                     │
│  • Record timing and sharpness                                        │
│                                                                         │
│  STEP 4: Analyze as phase transition                                   │
│  • Fit critical exponents near transition                            │
│  • Compare to BEC predictions                                         │
│  • Compare to Experiment 004 results                                  │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 4.2 Predictions

```
IF THEORY IS CORRECT:

Before grokking:
• High entropy (many hypotheses)
• Low-band entropy decreasing slowly
• Correlations building

At grokking:
• Sudden entropy drop (collapse)
• Power-law behavior near transition
• Critical exponents match Exp 004

After grokking:
• Low entropy (generalized state)
• Stable structure
```

---

## 5. Results

```
[ TO BE FILLED AFTER EXPERIMENT ]

Grokking occurred at step: _____
Entropy before: _____
Entropy after: _____

Critical exponent β: _____ (compare to Exp 004: _____)
Phase transition confirmed: YES / NO
```

---

## 6. Conclusion

```
[ TO BE FILLED AFTER EXPERIMENT ]

H1 (phase transition signatures): SUPPORTED / NOT SUPPORTED
H2 (building correlations): SUPPORTED / NOT SUPPORTED
H3 (matching exponents): SUPPORTED / NOT SUPPORTED

Grokking IS / IS NOT condensation.
```

---

*Oscar Goldman, Shogu Research Group @ Datamutant.ai subsidiary of 温心重工業*

